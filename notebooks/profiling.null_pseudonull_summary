-- ========================================
-- TEMPLATE: EDA_NULL_PSEUDONULL_COUNT
-- Descripci√≥n: Contar NULL reales y pseudo-NULL ('', 'NA', 'NaN', 'UNKNOWN', 'ERROR') por columna
-- ========================================

CREATE TABLE profiling.null_pseudonull_summary AS

SELECT
    -- Columna 1
    SUM(CASE
            WHEN "Transaction ID" IS NULL
              OR TRIM("Transaction ID") IN ('', 'NA', 'NaN', 'UNKNOWN', 'ERROR')
        THEN 1 ELSE 0 END) AS Transaction_ID_null_like,

    -- Columna 2
    SUM(CASE
            WHEN Item IS NULL
              OR TRIM(Item) IN ('', 'NA', 'NaN', 'UNKNOWN', 'ERROR')
        THEN 1 ELSE 0 END) AS Item_null_like,

    -- Columna 3
    SUM(CASE
            WHEN Quantity IS NULL
              OR TRIM(Quantity) IN ('', 'NA', 'NaN', 'UNKNOWN', 'ERROR')
        THEN 1 ELSE 0 END) AS Quantity_null_like,

    -- Columna 4
    SUM(CASE
            WHEN "Price Per Unit" IS NULL
              OR TRIM("Price Per Unit") IN ('', 'NA', 'NaN', 'UNKNOWN', 'ERROR')
        THEN 1 ELSE 0 END) AS Price_Per_Unit_null_like,

    -- Columna 5
    SUM(CASE
            WHEN "Total Spent" IS NULL
              OR TRIM("Total Spent") IN ('', 'NA', 'NaN', 'UNKNOWN', 'ERROR')
        THEN 1 ELSE 0 END) AS Total_Spent_null_like,

    -- Columna 6
    SUM(CASE
            WHEN "Payment Method" IS NULL
              OR TRIM("Payment Method") IN ('', 'NA', 'NaN', 'UNKNOWN', 'ERROR')
        THEN 1 ELSE 0 END) AS Payment_Method_null_like,

    -- Columna 7
    SUM(CASE
            WHEN Location IS NULL
              OR TRIM(Location) IN ('', 'NA', 'NaN', 'UNKNOWN', 'ERROR')
        THEN 1 ELSE 0 END) AS Location_null_like,

    -- Columna 8
    SUM(CASE
            WHEN "Transaction Date" IS NULL
              OR TRIM("Transaction Date") IN ('', 'NA', 'NaN', 'UNKNOWN', 'ERROR')
        THEN 1 ELSE 0 END) AS Transaction_Date_null_like

FROM;